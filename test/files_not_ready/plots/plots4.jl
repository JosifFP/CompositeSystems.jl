using GLMakie, ColorSchemes

y = [0,	25,	50,	75,	100, 125,	150,	175,	200,	225,	250,	275,	300]
x = [1, 2, 3, 4, 5, 6, 8, 9, 10]

z75 =[
    1404.98	1361.24	1323.23	1289.62	1258.77	1229.96	1203.03	1178.34	1155.21	1134.73	1117.53	1102.18	1087.64;
    1404.98	1361.24	1323.23	1289.62	1258.77	1229.96	1203.03	1178.34	1155.21	1134.73	1117.53	1102.18	1087.64;
    1404.98	1361.24	1323.23	1289.62	1258.77	1229.96	1203.03	1178.34	1155.21	1134.73	1117.53	1102.18	1087.64;
    1404.98	1361.23	1323.21	1289.59	1258.72	1229.89	1202.96	1178.25	1155.11	1134.62	1117.41	1102.04	1087.49;
    1404.98	1361.21	1323.18	1289.55	1258.67	1229.83	1202.88	1178.16	1155.01	1134.52	1117.30	1101.93	1087.38;
    1404.98	1361.24	1323.23	1289.62	1258.77	1229.96	1203.03	1178.34	1155.21	1134.73	1117.53	1102.18	1087.64;
    1404.98	1361.24	1323.23	1289.62	1258.77	1229.96	1203.03	1178.34	1155.21	1134.73	1117.53	1102.18	1087.64;
    1404.98	1361.24	1323.23	1289.62	1258.77	1229.96	1203.03	1178.34	1155.21	1134.73	1117.53	1102.18	1087.64;
    1404.98	1361.24	1323.23	1289.62	1258.77	1229.96	1203.03	1178.34	1155.21	1134.73	1117.53	1102.18	1087.64;  
]

z25 =[
    1404.98	1361.24	1325.38	1296.18	1277.36	1261.91	1249.02	1237.45	1227.04	1217.77	1210.08	1204.02	1199.96;
    1404.98	1361.24	1325.38	1296.18	1277.36	1261.91	1249.02	1237.45	1227.04	1217.77	1210.08	1204.02	1199.96;
    1404.98	1361.24	1325.38	1296.18	1277.36	1261.91	1249.02	1237.45	1227.04	1217.77	1210.08	1204.02	1199.96;
    1404.98	1361.23	1325.36	1296.15	1277.31	1261.84	1248.95	1237.36	1226.94	1217.65	1209.95	1203.90	1199.83;
    1404.98	1361.21	1325.33	1296.11	1277.26	1261.79	1248.90	1237.31	1226.89	1217.60	1209.90	1203.84	1199.76;
    1404.98	1361.24	1325.38	1296.18	1277.36	1261.91	1249.02	1237.45	1227.04	1217.77	1210.08	1204.02	1199.96;
    1404.98	1361.24	1325.38	1296.18	1277.36	1261.91	1249.02	1237.45	1227.04	1217.77	1210.08	1204.02	1199.96;
    1404.98	1361.24	1325.38	1296.18	1277.36	1261.91	1249.02	1237.45	1227.04	1217.77	1210.08	1204.02	1199.96;
    1404.98	1361.24	1325.38	1296.18	1277.36	1261.91	1249.02	1237.45	1227.04	1217.77	1210.08	1204.02	1199.96;    
]

z50 =[
    1404.98	1361.24	1323.23	1290.50	1259.96	1232.53	1207.74	1189.57	1173.35	1158.76	1145.05	1132.56	1120.67;
    1404.98	1361.24	1323.23	1290.50	1259.96	1232.53	1207.74	1189.57	1173.35	1158.76	1145.05	1132.56	1120.67;
    1404.98	1361.24	1323.23	1290.50	1259.96	1232.53	1207.74	1189.57	1173.35	1158.76	1145.05	1132.56	1120.67;
    1404.98	1361.23	1323.21	1290.46	1259.91	1232.46	1207.67	1189.48	1173.25	1158.65	1144.93	1132.42	1120.52;
    1404.98	1361.21	1323.18	1290.42	1259.86	1232.40	1207.59	1189.39	1173.15	1158.55	1144.83	1132.32	1120.42;
    1404.98	1361.24	1323.23	1290.50	1259.96	1232.53	1207.74	1189.57	1173.35	1158.76	1145.05	1132.56	1120.67;
    1404.98	1361.24	1323.23	1290.50	1259.96	1232.53	1207.74	1189.57	1173.35	1158.76	1145.05	1132.56	1120.67;
    1404.98	1361.24	1323.23	1290.50	1259.96	1232.53	1207.74	1189.57	1173.35	1158.76	1145.05	1132.56	1120.67;
    1404.98	1361.24	1323.23	1290.50	1259.96	1232.53	1207.74	1189.57	1173.35	1158.76	1145.05	1132.56	1120.67;
    
]

z100 =[
    1404.98	1361.24	1323.23	1289.62	1258.34	1229.35	1202.20	1176.73	1152.88	1131.15	1110.81	1091.66	1074.15;
    1404.98	1361.24	1323.23	1289.62	1258.34	1229.35	1202.20	1176.73	1152.88	1131.15	1110.81	1091.66	1074.15;
    1404.98	1361.24	1323.23	1289.62	1258.34	1229.35	1202.20	1176.73	1152.88	1131.15	1110.81	1091.66	1074.15;
    1404.98	1361.23	1323.21	1289.59	1258.29	1229.29	1202.12	1176.64	1152.78	1131.04	1110.69	1091.53	1074.00;
    1404.98	1361.21	1323.18	1289.55	1258.24	1229.22	1202.05	1176.55	1152.68	1130.93	1110.58	1091.42	1073.90;
    1404.98	1361.24	1323.23	1289.62	1258.34	1229.35	1202.20	1176.73	1152.88	1131.15	1110.81	1091.66	1074.15;
    1404.98	1361.24	1323.23	1289.62	1258.34	1229.35	1202.20	1176.73	1152.88	1131.15	1110.81	1091.66	1074.15;
    1404.98	1361.24	1323.23	1289.62	1258.34	1229.35	1202.20	1176.73	1152.88	1131.15	1110.81	1091.66	1074.15;
    1404.98	1361.24	1323.23	1289.62	1258.34	1229.35	1202.20	1176.73	1152.88	1131.15	1110.81	1091.66	1074.15;
]

f = Figure(resolution=(1200, 800), fontsize=24)
axs =Axis3(f[1,1]; title = "System EENS (MWh/year)", 
            xlabel = "Energy Storage location (#bus)", ylabel = "Energy Rating (MWh)", 
            zlabel = "EENS (MWh/y)",
            azimuth = -π/5,
            perspectiveness=0.0,
            elevation=π/6,
            zlabeloffset=100,
            xlabeloffset=60,
            ylabeloffset=60,
            xticks = WilkinsonTicks(10; k_min = 7),
            yticks = WilkinsonTicks(10; k_min = 6),
            zticks = WilkinsonTicks(6; k_min = 3),
            #aspect = (1,1,0.75)
            #aspect = :data
)

axis25 = (;
            title = "PR=25MW",
            ylabel = "Energy Rating (MWh)",
            yticks = WilkinsonTicks(6; k_min = 6),
            xticks = WilkinsonTicks(10; k_min = 10),
)

axis50 = (;
            title = "PR=50MW",
            yticks = WilkinsonTicks(6; k_min = 6),
            xticks = WilkinsonTicks(10; k_min = 10),
)
axis75 = (;
            title = "PR=75MW",
            ylabel = "Energy Rating (MWh)",
            xlabel = "ESS location (#bus)",
            yticks = WilkinsonTicks(6; k_min = 6),
            xticks = WilkinsonTicks(10; k_min = 10),
)

axis100 = (;
            title = "PR=100MW",
            xlabel = "ESS location (#bus)",
            yticks = WilkinsonTicks(6; k_min = 6),
            xticks = WilkinsonTicks(10; k_min = 10),
)


#fig, ax, hm = heatmap(x, y, z25, axis=axis25, figure=figure)
cmap = (:viridis, 0.9)
s = surface!(axs,(x) ,y , z25 , color = z25, colormap=cmap)
s = surface!(axs,(x) ,y , z50 , color = z50, colormap=cmap)
s = surface!(axs,(x) ,y , z75 , color = z75, colormap=cmap)
s = surface!(axs,(x) ,y , z100 , color = z100, colormap=cmap)

wireframe!(axs,(x), y, z25, shading=false, color = :black, linewidth=0.2, overdraw=true, transparency=true)
wireframe!(axs,(x), y, z50, shading=false, color = :black, linewidth=0.2, overdraw=true, transparency=true)
wireframe!(axs,(x), y, z75, shading=false, color = :black, linewidth=0.2, overdraw=true, transparency=true)
#wireframe!(axs,(x), y, z100, shading=false, color = :black, linewidth=0.2, overdraw=true, transparency=true)
Colorbar(f[2, 1], s, width=Relative(0.5), flipaxis = false, vertical = false)
rowgap!(f.layout, 80)
save("figure6.png", f)










ax, hm = heatmap(fig[1, 2], x, y, z50, axis=axis50)
ax, hm = heatmap(fig[2, 1], x, y, z75, axis=axis75)
ax, hm = heatmap(fig[2, 2], x, y, z100, axis=axis100)
Colorbar(fig[3, 1], hm, flipaxis = false, vertical = false, label = "EENS (MWh/year)")



save("figure5.png", fig)